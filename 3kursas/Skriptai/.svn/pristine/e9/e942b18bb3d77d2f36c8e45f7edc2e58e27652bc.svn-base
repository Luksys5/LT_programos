#! /bin/sh
#!perl -w # --*- Perl -*--
eval 'exec perl5 -x $0 ${1+"$@"}'
    if 0;
#------------------------------------------------------------------------------
#$Author$
#$Date$ 
#$Revision$
#$URL$
#------------------------------------------------------------------------------
#*
#  Convert encoding of lithuanian accented letters as used in
#  Palemonas and Vytis fonts into composite Unicode sequences in UTF8
#  encoding.
#**

use strict;

my %double_sequences = (
"\x{0069}\x{0307}\x{0300}" => "\x{E00C}",
"\x{0069}\x{0307}\x{0301}" => "\x{E00D}",
"\x{0069}\x{0307}\x{0303}" => "\x{E00E}",
"\x{012F}\x{0307}\x{0301}" => "\x{E010}",
"\x{012F}\x{0307}\x{0303}" => "\x{E012}",
"\x{006A}\x{0307}\x{0303}" => "\x{E014}",
);

my %triple_sequences = (
"\x{0104}\x{0301}" => "\x{E000}",
"\x{0105}\x{0301}" => "\x{E001}",
"\x{0104}\x{0303}" => "\x{E002}",
"\x{0105}\x{0303}" => "\x{E003}",
"\x{0118}\x{0301}" => "\x{E004}",
"\x{0119}\x{0301}" => "\x{E005}",
"\x{0118}\x{0303}" => "\x{E006}",
"\x{0119}\x{0303}" => "\x{E007}",
"\x{0116}\x{0301}" => "\x{E008}",
"\x{0117}\x{0301}" => "\x{E009}",
"\x{0116}\x{0303}" => "\x{E00A}",
"\x{0117}\x{0303}" => "\x{E00B}",
"\x{012E}\x{0301}" => "\x{E00F}",
"\x{012E}\x{0303}" => "\x{E011}",
"\x{004A}\x{0303}" => "\x{E013}",
"\x{004C}\x{0303}" => "\x{E015}",
"\x{006C}\x{0303}" => "\x{E016}",
"\x{004D}\x{0303}" => "\x{E017}",
"\x{006D}\x{0303}" => "\x{E018}",
"\x{0052}\x{0303}" => "\x{E019}",
"\x{0072}\x{0303}" => "\x{E01A}",
"\x{0172}\x{0301}" => "\x{E01B}",
"\x{0173}\x{0301}" => "\x{E01C}",
"\x{0172}\x{0303}" => "\x{E01D}",
"\x{0173}\x{0303}" => "\x{E01E}",
"\x{016A}\x{0301}" => "\x{E01F}",
"\x{016B}\x{0301}" => "\x{E020}",
"\x{016A}\x{0303}" => "\x{E021}",
"\x{016B}\x{0303}" => "\x{E022}",
);

## undef $/; # slurp the whole file

use open ':utf8';
binmode( STDIN, "utf8" );
binmode( STDOUT, "utf8" );

while(<>) {
    for my $hash (\%triple_sequences, \%double_sequences) {
	while( my ($key, $val) = each %$hash ) {
	    s/$val/$key/g;
	}
    }
    print;
}
